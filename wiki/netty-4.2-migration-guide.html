<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Netty.docs: Netty 4.2 Migration Guide</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport">
<link href="../images/favicon.ico" rel="shortcut icon">
<link href="//feeds.feedburner.com/netty_project" rel="alternate" title="News Feed" type="application/rss+xml">
<style>
  body {
    padding-top: 60px;
  }
</style>
<link href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" media="screen" rel="stylesheet" type="text/css">
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" media="screen" rel="stylesheet" type="text/css">
<script src="../lib/sh/scripts/shCore.js" type="text/javascript"></script>
<script src="../lib/sh/scripts/shBrushXml.js" type="text/javascript"></script>
<link href="../lib/sh/styles/shCore.css" rel="stylesheet" type="text/css">
<link href="../lib/sh/styles/shThemeDefault.css" rel="stylesheet" type="text/css">
<link href="../lib/common.css" rel="stylesheet" type="text/css">
<script src="../lib/common.js" type="text/javascript"></script>
<!--[if lt IE 9]>
<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.js" type="text/javascript"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/respond.js/1.3.0/respond.js" type="text/javascript"></script>
<![endif]-->
</head>
<body>
<a class="sr-only" href="#content" id="top">Skip navigation</a>
<nav class="navbar navbar-default navbar-fixed-top hidden-print" id="header" role="navigation">
<div class="container">
<div class="navbar-header">
<button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="../index.html">
<span class="navbar-brand-logo"></span>
Netty project
</a>
</div>
<div class="navbar-collapse collapse">
<ul class="nav navbar-nav">
<li class="dropdown">
<a href="../news/2025/09/08/4-2-6.html">
News
</a>
<ul class="dropdown-menu">
<li>
<a href="../news/index.html">
<i class="fa fa-archive"></i>
Archive
</a>
</li>
</ul>
</li>
<li class="dropdown">
<a href="../downloads.html">
Downloads
</a>
<ul class="dropdown-menu">
<li>
<a href="https://github.com/netty/netty/archive/refs/tags/netty-5.0.0.Alpha5.tar.gz">
<i class="fa fa-cloud-download"></i>
5.0.0.Alpha5
<small>&dash; 28-Sep-2022</small>
</a>
</li>
<li>
<a href="https://github.com/netty/netty/archive/refs/tags/netty-4.2.6.Final.tar.gz">
<i class="fa fa-cloud-download"></i>
4.2.6.Final
<small>&dash; 08-Sep-2025</small>
</a>
</li>
<li>
<a href="https://github.com/netty/netty/archive/refs/tags/netty-4.1.127.Final.tar.gz">
<i class="fa fa-cloud-download"></i>
4.1.127.Final
<small>&dash; 08-Sep-2025</small>
</a>
</li>
<li>
<a href="https://github.com/netty/netty/archive/refs/tags/netty-4.0.56.Final.tar.gz">
<i class="fa fa-cloud-download"></i>
4.0.56.Final
<small>&dash; 05-Feb-2018</small>
</a>
</li>
<li>
<a href="https://github.com/netty/netty/archive/refs/tags/netty-3.10.6.Final.tar.gz">
<i class="fa fa-cloud-download"></i>
3.10.6.Final
<small>&dash; 29-Jun-2016</small>
</a>
</li>
<li>
<a href="https://www.tldrlegal.com/l/APACHE2">
<i class="fa fa-gavel"></i>
Apache License 2.0
</a>
</li>
<li>
<a href="https://github.com/netty/netty/releases">
<i class="fa fa-archive"></i>
Previous Releases
</a>
</li>
<li>
<a href="https://oss.sonatype.org/content/repositories/snapshots/io/netty/">
<i class="fa fa-flask"></i>
Nightly Builds
</a>
</li>
</ul>
</li>
<li class="dropdown">
<a href="../wiki/index.html">
Documentation
</a>
<ul class="dropdown-menu">
<li>
<a href="../wiki/user-guide.html">
<i class="fa fa-book"></i>
User guide
</a>
</li>
<li>
<a href="../5.0/api/index.html">
<i class="fa fa-file-text"></i>
Javadoc - 5.0
</a>
</li>
<li>
<a href="../4.2/api/index.html">
<i class="fa fa-file-text"></i>
Javadoc - 4.2
</a>
</li>
<li>
<a href="../4.1/api/index.html">
<i class="fa fa-file-text"></i>
Javadoc - 4.1
</a>
</li>
<li>
<a href="../4.0/api/index.html">
<i class="fa fa-file-text"></i>
Javadoc - 4.0
</a>
</li>
<li>
<a href="../3.10/api/index.html">
<i class="fa fa-file-text"></i>
Javadoc - 3.10
</a>
</li>
<li>
<a href="../wiki/all-documents.html">
<i class="fa fa-list"></i>
All Documents
</a>
</li>
<li>
<a href="../wiki/related-articles.html">
<i class="fa fa-bookmark"></i>
Related Articles
</a>
</li>
<li class="hidden-xs" id="bookpromo-dropdown">
<a href="https://www.manning.com/maurer/">
<img src="../images/netty-in-action.gif">
<br>
<small>
Use code <strong>mlnettyco</strong>
<br>
for a 37% discount!
</small>
</a>
</li>
</ul>
</li>
<li class="dropdown">
<a href="../community.html">
Get Involved
</a>
<ul class="dropdown-menu">
<li>
<a href="https://github.com/netty/netty">
<i class="fa fa-github-square"></i>
Github
</a>
</li>
<li>
<a href="https://stackoverflow.com/questions/tagged/netty">
<i class="fa fa-stack-overflow"></i>
StackOverflow
</a>
</li>
<li>
<a href="https://twitter.com/netty_project">
<i class="fa fa-twitter-square"></i>
@netty_project
</a>
</li>
<li>
<a href="../wiki/developer-guide.html">
<i class="fa fa-cogs"></i>
Developer Guide
</a>
</li>
<li>
<a href="https://discord.gg/GkGzzdQM5d">
<i class="fa fa-comment"></i>
Discord Server
</a>
</li>
<li>
<a href="../sponsor/thanks.html">
<i class="fa fa-usd"></i>
Sponsors
</a>
</li>
<li>
<a href="../wiki/adopters.html">
<i class="fa fa-users"></i>
Adopters
</a>
</li>
<li>
<a href="../wiki/related-projects.html">
<i class="fa fa-chain"></i>
Related Projects
</a>
</li>
</ul>
</li>
<li class="visible-xs" id="bookpromo-nav">
<a href="https://www.manning.com/maurer/">
<img src="../images/netty-in-action.gif">
<br>
<small>
Use code <strong>mlnettyco</strong>
<br>
for a 37% discount!
</small>
</a>
</li>
<li>
<a href="https://feeds.feedburner.com/netty_project">
<i class="fa fa-rss"></i>
</a>
</li>
</ul>
<form action="../search.html" class="navbar-form navbar-right hidden-sm" method="GET" onsubmit="return validateGlobalSearchQuery()" role="search">
<div class="form-group">
<input class="search-query form-control" id="global-search-query" name="q" placeholder="Search" type="text">
</div>
</form>
</div>
</div>
</nav>
<div id="content">
<div class="container">
<div class="wiki-item">
<h1>Netty 4.2 Migration Guide</h1>
<div class="alert alert-info">
Did you know this page is automatically generated from
<a href="https://github.com/netty/netty/wiki/Netty-4.2-Migration-Guide">a Github Wiki page?</a>
You can improve it by yourself
<a href="https://github.com/netty/netty/wiki/Netty-4.2-Migration-Guide">here!</a>
</div>
<div class="row">
<div class="col-md-9">
<div id="wiki-body" class="gollum-markdown-content">
              <div class="markdown-body">
                <div class="markdown-heading">
<h1 class="heading-element">Netty 4.2 Migration Guide</h1>
<a id="user-content-netty-42-migration-guide" class="anchor" aria-label="Permalink: Netty 4.2 Migration Guide" href="#netty-42-migration-guide"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>Netty 4.2 is largely backwards compatible with Netty 4.1, but there are a few choice compatibility breakages to be aware of, and a couple of new features worth knowing about.</p>
<p>From our (the Netty team) perspective, one of the biggest changes is that we are changing the minimum Java version requirement from Java 6 to Java 8. This upgrade is a big quality-of-life improvement for us, but it likely has no impact on anyone else because there are almost no regularly maintained Java projects left that still use Java versions older than Java 8.</p>
<div class="markdown-heading">
<h2 class="heading-element" id="wiki-h2-0">Recommended upgrade process</h2>
<a id="user-content-recommended-upgrade-process" class="anchor" aria-label="Permalink: Recommended upgrade process" href="#recommended-upgrade-process"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>The following is the recommended process for upgrading systems to Netty 4.2, that we have developed from practical experience.
The process described here is high-level and generic, to accommodate a wide range of systems.
Please read through the other sections of this migration guide, for details and tips that may be relevant to your specific system.</p>
<p>Before you begin, it is recommended that your systems use the dependency management best practices.
Specifically, you should avoid shading as much as possible, since this process hides dependencies from dependency management tools like Maven and Gradle.
You should also be using BOM files, such as <code>netty-bom</code>, to control your dependency versions.
Following those practices will help you avoid ending up with a mix of versions at runtime.</p>
<p>The Netty 4.2 upgrade may take multiple sprints and deployment cycles, depending on the size and complexity of your systems.
Plan accordingly, to ensure you have the time and resources to see the project through to its completion.</p>
<p>These are the recommended steps for upgrading to Netty 4.2:</p>
<ol>
<li>
<strong>Upgrade to the latest Netty 4.1.x.</strong> <br>
Before you begin upgrading to Netty 4.2, make sure your systems are working correctly with the latest 4.1.x version.</li>
<li>
<strong>Ensure endpoint validation is explicitly configured for client TLS connections.</strong> <br>
In Netty 4.2, the default setting for endpoint validation (aka. hostname verification) changes.
If you have TLS clients, make sure you explicitly configure endpoint validation to either <em>on</em> (recommended) or <em>off</em> (for niche use cases).
The endpoint validation <em>must</em> be configured using the <a href="https://netty.io/4.1/api/io/netty/handler/ssl/SslContextBuilder.html#endpointIdentificationAlgorithm-java.lang.String-" rel="nofollow">SslContextBuilder.endpointIdentificationAlgorithm(String)</a> API that was added in Netty 4.1.112.</li>
<li>
<strong>Repeat step 1 and 2 for all your dependencies.</strong> <br>
It is important to ensure that all the components of your system is using the same Netty version, and are all configuring endpoint validation correctly.
First off, this avoids any surprises from older client libraries that configure endpoint validation incorrectly, and may as a result stop working after a Netty 4.2 upgrade.
Secondly, Netty 4.1 and 4.2 cannot co-exist on the class path, so you need to ensure you do the upgrade in a single step.</li>
<li>
<strong>Explicitly configure your system to use the pooled allocator.</strong> <br>
Netty 4.2 changes the default allocator to <code>adaptive</code>.
To de-risk this change, it is recommended to first upgrade to 4.2 while explicitly configuring the pooled allocator, and then remove the allocator configuration as a second step.
To explicitly configure the pooled allocator, set this system property: <code>io.netty.allocator.type=pooled</code>.</li>
<li>
<strong>Deploy your system with the above changes and make sure it works.</strong> <br>
The changes described in the steps 1 through 4 can all be deployed in one go, with the caveat that you may have libraries and frameworks on their own upgrade and release cycle.
At this point, your system is still running Netty 4.1, but you are now ready for the 4.2 upgrade.</li>
<li>
<strong>Upgrade to the latest Netty 4.2.x, and deploy it.</strong> <br>
At this step, we just bump the Netty version to the last 4.2.x, and roll it out.
Inspect your build and ensure that you have no Netty 4.1 dependencies left.
As your build pipelines and deployments roll-out, watch out for errors related to endpoint validation in TLS clients, as this is the main risk for most systems.
Once this is done and everything looks good, then you can choose to stop here if you are not interested in the <code>adaptive</code> allocator, otherwise you can proceed.</li>
<li>
<strong>Switch to the adaptive allocator.</strong> <br>
The <code>adaptive</code> allocator is the new default, but it is not necessary the best choice for everyone.
It will be better for some workloads, and worse for others.
If you have a load-test or soak-test environment, try the <code>adaptive</code> allocator there first.
Simply remove the <code>io.netty.allocator.type=pooled</code> system property that we added in step 4.
If it looks good, then proceed with deploying the change through your environments to production, and watch out for heap and direct memory usage and GC activity as the changes rolls out.
If you see a significant increase in memory usage from the <code>adaptive</code> allocator, feel free to obtain a flight recording using our <a href="https://github.com/netty/netty/blob/4.2/microbench/src/main/resources/Netty%20Allocator%20Events.jfc">Netty Allocator Events.jfc</a> recording profile, and open an issue about it with a recording attached.
If the <code>adaptive</code> allocator is performing poorly for your workload, you can simply stay with the <code>pooled</code> allocator while we work to make the <code>adaptive</code> allocator better.</li>
</ol>
<p>Following the above steps will give you a good chance at successfully upgrading to Netty 4.2, with few or no surprises.</p>
<div class="markdown-heading">
<h2 class="heading-element" id="wiki-h2-1">Compatibility highlights</h2>
<a id="user-content-compatibility-highlights" class="anchor" aria-label="Permalink: Compatibility highlights" href="#compatibility-highlights"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>These are the most important compatibility breakages. The Netty team has done extensive validation testing of 4.2 in a number of large and high-profile projects, and these are the things that integrators are most likely to run into when upgrading their Netty dependencies from 4.1 to 4.2:</p>
<p><strong><g-emoji class="g-emoji" alias="warning">⚠️</g-emoji> For client TLS connections, we now enable hostname verification by default.</strong></p>
<p>The <code>SslContextBuilder.endpointIdentificationAlgorithm</code> setting is now set to <code>HTTPS</code> by default, where in 4.1 it was <code>null</code> by default. Not doing hostname verification is obsolete and insecure practice from a more innocent time, that we haven't been able to change until now since suddenly enabling it could potentially break many systems.</p>
<p>This default can be overridden with a system property, to restore the Netty 4.1 behavior:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="io.netty.handler.ssl.defaultEndpointVerificationAlgorithm=NONE"><pre class="notranslate"><code>io.netty.handler.ssl.defaultEndpointVerificationAlgorithm=NONE&#x000A;</code></pre></div>
<p>The purpose of this override is to aid systems with the Netty 4.2 migration. Systems that intentionally wish to disable endpoint identification should do so through the <code>SslContextBuilder</code> option.</p>
<p><strong><g-emoji class="g-emoji" alias="warning">⚠️</g-emoji> The <code>adaptive</code> memory allocator is now the default.</strong></p>
<p>In Netty 4.1 the <code>adaptive</code> memory allocator was experimental. We have now made it the new default instead of the <code>pooled</code> allocator.</p>
<p>We believe that most workloads will observe reduced memory usage, with performance that is on par or slightly better than the pooled allocator. The adaptive allocator automatically tunes itself to perform well for the observed workload. It was also designed from the start to work well with virtual threads.</p>
<p>However, every application use their allocator in different ways, and stress them differently, so it is expected that the adaptive allocator will perform worse for some. Integrators who wish to keep using the pooled allocator like they did in Netty 4.1, can change the default allocator by setting this system property:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="io.netty.allocator.type=pooled"><pre class="notranslate"><code>io.netty.allocator.type=pooled&#x000A;</code></pre></div>
<p><strong><g-emoji class="g-emoji" alias="warning">⚠️</g-emoji> BouncyCastle upgrade.</strong></p>
<p>We have updated our (still optional) BouncyCastle dependency. This is a breaking change because of how BouncyCastle versions their artifacts.</p>
<p>Our BouncyCastle dependencies have all changed from their <code>*-jdk15on</code> variants to their <code>*-jdk18on</code> variants.</p>
<p>This means that if you, for instance, are depending on both Netty and <code>bcprov-jdk15on</code>, then you will have to change which BouncyCastle artifact you depend on as part of your Netty 4.2 migration.</p>
<p>We have also upgraded the version we depend on from 1.69 to 1.80, which itself introduces compatibility breakages in their API.</p>
<p><strong><g-emoji class="g-emoji" alias="warning">⚠️</g-emoji> The <code>netty-incubator-transport-io_uring</code> module is no longer supported.</strong></p>
<p>In Netty 4.2 we have <em>graduated</em> the io_uring transport from incubator, to a fully supported first-class transport module.</p>
<p>As part of this work, we have made numerous refactorings to the Netty transport internals that render the incubator version entirely incompatible. The good news is that <code>netty-transport-native-io_uring</code> is a much superior implementation thanks to these refactorings.</p>
<p>Integrators are encouraged to stop using the incubator module, and instead move to Netty 4.2 for its superior io_uring integration. Doing so will unfortunately require code changes. The following are things to watch out for:</p>
<ul>
<li>The package name changes from <code>io.netty.incubator.channel.uring</code> to <code>io.netty.channel.uring</code>.</li>
<li>Class names are now prefixed <code>IoUring</code> instead of <code>IOUring</code> (note the lower-case ‘o’).</li>
<li>A number of io_uring channel options have changed.</li>
<li>
<code>IOUringEventLoopGroup</code> does not exist anymore and is superseded by <code>MultiThreadIoEventLoopGroup</code> and <code>IoUringIoHandler</code>.</li>
<li>Usage of io_uring now requires Java9+.</li>
</ul>
<div class="markdown-heading">
<h2 class="heading-element" id="wiki-h2-2">Lesser compatibility changes</h2>
<a id="user-content-lesser-compatibility-changes" class="anchor" aria-label="Permalink: Lesser compatibility changes" href="#lesser-compatibility-changes"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>Netty 4.2 also includes a number of compatibility breakages that are less likely to cause problems, but needs to be mentioned regardless.</p>
<ul>
<li>The <code>protobuf-java</code> dependency has received a major version bump from 2.6.1 to 3.25.5.</li>
<li>The <code>netty-codec</code> module has been split into a number of different sub-modules, which the <code>netty-codec</code> module then depends on. In other words, <code>netty-codec</code> is now multiple jar files instead of one.</li>
<li>We have dropped support for obsolete WebSocket draft specifications.</li>
<li>Dropped support for Jetty alpn/npn as ALPN is supported out of the box when using Java8.</li>
<li>The pipeline call-stack has been flattened, to reduce stack depths when processing messages through the pipeline. This may cause changes in behavior when messages are processed through the pipeline while the pipeline is concurrently modified, or when the pipeline makes use of child-executors.</li>
<li>The minimum required GLibC version is bumped from 2.12 (May 2010, e.g. CentOS 6) to 2.17 (December 2012, e.g. CentOS 7).</li>
<li>We are no longer testing our tcnative dynamic-linked OpenSSL integration with OpenSSL 1.0.1e (2013), and are now instead testing with OpenSSL 1.0.2k (2017).</li>
<li>Switched from automatic to real modules for JPMS.</li>
</ul>
<p>The complete and exhaustive list of API breakages has been compiled by RevAPI:
<a href="https://github.com/netty/netty/blob/3ca17a96cf84cbcb08776d3731b222b82814ead7/pom.xml#L1271-L7794">https://github.com/netty/netty/blob/3ca17a96cf84cbcb08776d3731b222b82814ead7/pom.xml#L1271-L7794</a></p>
<div class="markdown-heading">
<h2 class="heading-element" id="wiki-h2-3">New best practices</h2>
<a id="user-content-new-best-practices" class="anchor" aria-label="Permalink: New best practices" href="#new-best-practices"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>Netty 4.2 introduces some new APIs, and deprecates some old APIs. As part of your migration to Netty 4.2, we encourage you to look through your code base for opportunities to clean up any use of deprecated APIs.</p>
<p><strong>✅ IoHandlerFactories for EventLoopGroups</strong></p>
<p>All transport-specific event loop groups, such as <code>NioEventLoopGroup</code>, have been deprecated.</p>
<p>Integrators should now instead pass a transport-specific <code>IoHandlerFactory</code> to a <code>MultiThreadedEventLoopGroup</code> constructor.</p>
<p>For example, stop doing this</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="EventLoopGroup group = new NioEventLoopGroup(); // ❌"><pre class="notranslate"><code>EventLoopGroup group = new NioEventLoopGroup(); // ❌&#x000A;</code></pre></div>
<p>and instead start doing this</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="EventLoopGroup group = new MultiThreadIoEventLoopGroup(NioIoHandler.newFactory()); // ✅"><pre class="notranslate"><code>EventLoopGroup group = new MultiThreadIoEventLoopGroup(NioIoHandler.newFactory()); // ✅&#x000A;</code></pre></div>
<p>There is a static <code>newFactory</code> method for each of our transports:</p>
<ul>
<li><code>NioIoHandler.newFactory()</code></li>
<li><code>EpollIoHandler.newFactory()</code></li>
<li><code>KQueueIoHandler.newFactory()</code></li>
<li><code>IoUringIoHandler.newFactory()</code></li>
<li><code>LocalIoHandler.newFactory()</code></li>
</ul>
<p>Note that you must still configure the relevant channel or channel factory in your <code>Bootstrap</code> or <code>ServerBootstrap</code> instances.</p>
<p><strong>✅ Extensibility of <code>MultiThreadIoEventLoopGroup</code> and <code>SingleThreadIoEventLoop</code></strong></p>
<p>The <code>MultiThreadIoEventLoopGroup</code> and <code>SingleThreadIoEventLoop</code> classes provide various methods that can be overridden by the user, and provide the ability to:</p>
<ul>
<li>Get a count of registered channels / handles</li>
<li>Understand how long the IO processing vs task processing took</li>
<li>Get how many channels / handles were processed per loop run</li>
<li>Customize / decorate promises</li>
</ul>
<p>Furthermore, it is now possible to register other things than Channels (as long as the correct <code>IoHandle</code> type is implemented), which provides a lot of possibilites to re-use netty components and also add support for other <code>IoHandle</code> implementations which does not exists as of today. For example, this could be used to implement file IO with io_uring.</p>
<p><strong>✅ Use netty-pkitesting instead of SelfSignedCertificate</strong></p>
<p>Netty 4.1 includes a <code>SelfSignedCertificate</code> class, which we use for testing our TLS implementation.
This was not intended to be used as widely as it has ended up, and it suffers from a number of API decisions that make it a poor fit as a general purpose PKI and TLS testing tool.</p>
<p>In Netty 4.2 we are introducing a new module, <code>netty-pkitesting</code>, which includes a <code>CertificateBuilder</code> class.
The <code>CertificateBuilder</code> is designed to allow integrators to test all sorts of PKI and TLS scenarios.</p>
<p>You can make self-signed certificates like before, or you can make proper CA, issuer, leaf certificate chains.
The <code>CertificateBuilder</code> produces <code>X509Bundle</code> objects, which contain both certificate chains and the corresponding private key, and the bundles are created entirely in-memory without writing any files.
If you need files for certificates, keys, or key stores, then the bundle objects include a number of convenient methods for creating temporary files for these.</p>
<p>The <code>netty-pkitesting</code> module also includes a simple Certificate Revocation List server, so you can test scenarios where certificates are revoked.</p>

              </div>

          </div></div>
<div class="toc-container col-md-3 hidden-xs hidden-sm hidden-print" role="complementary">
<div class="toc well">
<ul class="nav nav-list nav-stacked">
<li class="nav-header">Table of Contents
</li><li><a href="#wiki-h2-0" title="Recommended upgrade process">Recommended upgrade process</a>
</li><li><a href="#wiki-h2-1" title="Compatibility highlights">Compatibility highlights</a>
</li><li><a href="#wiki-h2-2" title="Lesser compatibility changes">Lesser compatibility changes</a>
</li><li><a href="#wiki-h2-3" title="New best practices">New best practices</a>
<ul class="nav nav-list nav-stacked"><li><a href="#wiki-h3-4" title="Toggle table of contents

      Pages 32">Toggle table of contents

      Pages 32</a>
</li><li><a href="#wiki-h3-5" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-6" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-7" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-8" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-9" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-10" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-11" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-12" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-13" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-14" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-15" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-16" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-17" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-18" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-19" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-20" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-21" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-22" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-23" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-24" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-25" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-26" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-27" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-28" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-29" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-30" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-31" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-32" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-33" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-34" title="Uh oh!">Uh oh!</a>
</li><li><a href="#wiki-h3-35" title="Uh oh!">Uh oh!</a>
</li></ul>
</li></ul>
</div>
</div>
</div>

<div class="row">
<div class="col-md-9">
<div class="text-right">
<small>Last retrieved on 08-Sep-2025</small>
</div>
</div>
</div>
</div>

</div>

</div>
<div class="container">
<hr>
<div id="footer">
<p>
Copyright &copy; 2025
<a href="../index.html">The Netty project</a>
</p>
</div>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js" type="text/javascript"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js" type="text/javascript"></script>
<script src="../lib/common.footer.js" type="text/javascript"></script>

<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-95307-5', 'auto');
ga('require', 'displayfeatures');
ga('require', 'linkid', 'linkid.js');
ga('send', 'pageview');
</script>
</body>
</html>
