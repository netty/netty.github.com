<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Netty.docs: Netty 5 Migration Guide</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport">
<link href="../images/favicon.ico" rel="shortcut icon">
<link href="//feeds.feedburner.com/netty_project" rel="alternate" title="News Feed" type="application/rss+xml">
<style>
  body {
    padding-top: 60px;
  }
</style>
<link href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" media="screen" rel="stylesheet" type="text/css">
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" media="screen" rel="stylesheet" type="text/css">
<script src="../lib/sh/scripts/shCore.js" type="text/javascript"></script>
<script src="../lib/sh/scripts/shBrushXml.js" type="text/javascript"></script>
<link href="../lib/sh/styles/shCore.css" rel="stylesheet" type="text/css">
<link href="../lib/sh/styles/shThemeDefault.css" rel="stylesheet" type="text/css">
<link href="../lib/common.css" rel="stylesheet" type="text/css">
<script src="../lib/common.js" type="text/javascript"></script>
<!--[if lt IE 9]>
<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.js" type="text/javascript"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/respond.js/1.3.0/respond.js" type="text/javascript"></script>
<![endif]-->
</head>
<body>
<a class="sr-only" href="#content" id="top">Skip navigation</a>
<nav class="navbar navbar-default navbar-fixed-top hidden-print" id="header" role="navigation">
<div class="container">
<div class="navbar-header">
<button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="../index.html">
<span class="navbar-brand-logo"></span>
Netty project
</a>
</div>
<div class="navbar-collapse collapse">
<ul class="nav navbar-nav">
<li class="dropdown">
<a href="../news/2024/11/13/quic-0-0-69-Final.html">
News
</a>
<ul class="dropdown-menu">
<li>
<a href="../news/index.html">
<i class="fa fa-archive"></i>
Archive
</a>
</li>
</ul>
</li>
<li class="dropdown">
<a href="../downloads.html">
Downloads
</a>
<ul class="dropdown-menu">
<li>
<a href="https://github.com/netty/netty/archive/refs/tags/netty-5.0.0.Alpha5.tar.gz">
<i class="fa fa-cloud-download"></i>
5.0.0.Alpha5
<small>&dash; 28-Sep-2022</small>
</a>
</li>
<li>
<a href="https://github.com/netty/netty/archive/refs/tags/netty-4.2.0.Beta1.tar.gz">
<i class="fa fa-cloud-download"></i>
4.2.0.Beta1
<small>&dash; 04-Nov-2024</small>
</a>
</li>
<li>
<a href="https://github.com/netty/netty/archive/refs/tags/netty-4.1.115.Final.tar.gz">
<i class="fa fa-cloud-download"></i>
4.1.115.Final
<small>&dash; 12-Nov-2024</small>
</a>
</li>
<li>
<a href="https://github.com/netty/netty/archive/refs/tags/netty-4.0.56.Final.tar.gz">
<i class="fa fa-cloud-download"></i>
4.0.56.Final
<small>&dash; 05-Feb-2018</small>
</a>
</li>
<li>
<a href="https://github.com/netty/netty/archive/refs/tags/netty-3.10.6.Final.tar.gz">
<i class="fa fa-cloud-download"></i>
3.10.6.Final
<small>&dash; 29-Jun-2016</small>
</a>
</li>
<li>
<a href="https://www.tldrlegal.com/l/APACHE2">
<i class="fa fa-gavel"></i>
Apache License 2.0
</a>
</li>
<li>
<a href="https://github.com/netty/netty/releases">
<i class="fa fa-archive"></i>
Previous Releases
</a>
</li>
<li>
<a href="https://oss.sonatype.org/content/repositories/snapshots/io/netty/">
<i class="fa fa-flask"></i>
Nightly Builds
</a>
</li>
</ul>
</li>
<li class="dropdown">
<a href="../wiki/index.html">
Documentation
</a>
<ul class="dropdown-menu">
<li>
<a href="../wiki/user-guide.html">
<i class="fa fa-book"></i>
User guide
</a>
</li>
<li>
<a href="../5.0/api/index.html">
<i class="fa fa-file-text"></i>
Javadoc - 5.0
</a>
</li>
<li>
<a href="../4.2/api/index.html">
<i class="fa fa-file-text"></i>
Javadoc - 4.2
</a>
</li>
<li>
<a href="../4.1/api/index.html">
<i class="fa fa-file-text"></i>
Javadoc - 4.1
</a>
</li>
<li>
<a href="../4.0/api/index.html">
<i class="fa fa-file-text"></i>
Javadoc - 4.0
</a>
</li>
<li>
<a href="../3.10/api/index.html">
<i class="fa fa-file-text"></i>
Javadoc - 3.10
</a>
</li>
<li>
<a href="../wiki/all-documents.html">
<i class="fa fa-list"></i>
All Documents
</a>
</li>
<li>
<a href="../wiki/related-articles.html">
<i class="fa fa-bookmark"></i>
Related Articles
</a>
</li>
<li class="hidden-xs" id="bookpromo-dropdown">
<a href="https://www.manning.com/maurer/">
<img src="../images/netty-in-action.gif">
<br>
<small>
Use code <strong>mlnettyco</strong>
<br>
for a 37% discount!
</small>
</a>
</li>
</ul>
</li>
<li class="dropdown">
<a href="../community.html">
Get Involved
</a>
<ul class="dropdown-menu">
<li>
<a href="https://github.com/netty/netty">
<i class="fa fa-github-square"></i>
Github
</a>
</li>
<li>
<a href="https://stackoverflow.com/questions/tagged/netty">
<i class="fa fa-stack-overflow"></i>
StackOverflow
</a>
</li>
<li>
<a href="https://twitter.com/netty_project">
<i class="fa fa-twitter-square"></i>
@netty_project
</a>
</li>
<li>
<a href="../wiki/developer-guide.html">
<i class="fa fa-cogs"></i>
Developer Guide
</a>
</li>
<li>
<a href="https://discord.gg/GkGzzdQM5d">
<i class="fa fa-comment"></i>
Discord Server
</a>
</li>
<li>
<a href="../sponsor/thanks.html">
<i class="fa fa-usd"></i>
Sponsors
</a>
</li>
<li>
<a href="../wiki/adopters.html">
<i class="fa fa-users"></i>
Adopters
</a>
</li>
<li>
<a href="../wiki/related-projects.html">
<i class="fa fa-chain"></i>
Related Projects
</a>
</li>
</ul>
</li>
<li class="visible-xs" id="bookpromo-nav">
<a href="https://www.manning.com/maurer/">
<img src="../images/netty-in-action.gif">
<br>
<small>
Use code <strong>mlnettyco</strong>
<br>
for a 37% discount!
</small>
</a>
</li>
<li>
<a href="https://feeds.feedburner.com/netty_project">
<i class="fa fa-rss"></i>
</a>
</li>
</ul>
<form action="../search.html" class="navbar-form navbar-right hidden-sm" method="GET" onsubmit="return validateGlobalSearchQuery()" role="search">
<div class="form-group">
<input class="search-query form-control" id="global-search-query" name="q" placeholder="Search" type="text">
</div>
</form>
</div>
</div>
</nav>
<div id="content">
<div class="container">
<div class="wiki-item">
<h1>Netty 5 Migration Guide</h1>
<div class="alert alert-info">
Did you know this page is automatically generated from
<a href="https://github.com/netty/netty/wiki/Netty-5-Migration-Guide">a Github Wiki page?</a>
You can improve it by yourself
<a href="https://github.com/netty/netty/wiki/Netty-5-Migration-Guide">here!</a>
</div>
<div class="row">
<div class="col-md-9">
<div id="wiki-body" class="gollum-markdown-content">
              <div class="markdown-body">
                <div class="markdown-heading">
<h1 class="heading-element">Netty 5 Migration Guide</h1>
<a id="user-content-netty-5-migration-guide" class="anchor" aria-label="Permalink: Netty 5 Migration Guide" href="#netty-5-migration-guide"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<div class="markdown-heading">
<h2 class="heading-element" id="wiki-h2-0">Package</h2>
<a id="user-content-package" class="anchor" aria-label="Permalink: Package" href="#package"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>To allow have netty 5 and netty 4 co-exist on the same classpath we changed the package name of netty 5 classes to <code>io.netty5.*</code>.</p>
<div class="markdown-heading">
<h2 class="heading-element" id="wiki-h2-1">Buffers</h2>
<a id="user-content-buffers" class="anchor" aria-label="Permalink: Buffers" href="#buffers"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>Netty 5 introduces a new Buffer API, that is simpler and safer to use than <code>ByteBuf</code>.</p>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-2">Capacity</h3>
<a id="user-content-capacity" class="anchor" aria-label="Permalink: Capacity" href="#capacity"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>The Netty 4.1 <code>ByteBuf</code> would automatically expand in capacity as needed when written to, until a certain maximum capacity.</p>
<p>The new <code>Buffer</code> API no longer do this, and no longer have a capacity and max-capacity distinction.
Code should instead allocate properly sized buffers (the size argument is now mandatory), and/or call <code>ensureWritable()</code> as needed.
The <code>ensureWritable()</code> method can now also take arguments that allow it to a compaction (the same as the old <code>discardReadBytes()</code>) and expansion at the same time, in a single memory copy.</p>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-3">Adaptors</h3>
<a id="user-content-adaptors" class="anchor" aria-label="Permalink: Adaptors" href="#adaptors"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>A set of adaptors are included, which can convert between the two APIs, and allow them to co-exist, until all handles and relevant code has been migrated.</p>
<p>The <code>ByteBufBuffer.wrap()</code> method takes a <code>ByteBuf</code> instance and returns a <code>Buffer</code> - a buffer instance of the new API.
Conversely, the <code>ByteBufAdaptor.intoByteBuf</code> method takes a <code>Buffer</code> and returns a <code>ByteBuf</code>.
Both of these methods will do the conversion in the most efficient way possible, and multiple conversions will undo each other to avoid nesting adaptors.</p>
<p>A <code>BufferConversionHandler</code> is also included, which can be inserted into the pipeline between handles that rely on different APIs.
Note that the <code>BufferConversionHandler</code> is unable to convert any <code>ByteBufHolder</code> or <code>BufferHolder</code> objects.
Objects that contain <code>Buffer</code> or <code>ByteBuf</code> instances will need to be converted with e.g. a custom <code>MessageToMessageCodec</code>.</p>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-4">Changes in API</h3>
<a id="user-content-changes-in-api" class="anchor" aria-label="Permalink: Changes in API" href="#changes-in-api"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>The key difference in the new <code>Buffer</code> API is that <em>aliasing</em> is no longer allowed.
Aliasing is when two or more buffer objects refer to the same underlying memory.
This means that methods like <code>slice()</code> and <code>duplicate()</code> are no longer available.
On the other hand, the life-cycle handling is simplified, and reference counting can be entirely removed from the API.</p>
<p>Where you would have used <code>slice()</code>, <code>duplicate()</code>, and their <code>retain*</code> variants, and the <code>retain()</code> family of methods, you will now instead use <code>split()</code>, <code>readSplit()</code>, and <code>copy()</code>.</p>
<p>The <code>split</code> family of methods are similar to <code>slice()</code>, except they can only slice at the ends of the buffer, and the returned buffer slice is <em>removed</em> from the original buffer, thus preventing aliasing.</p>
<p>The <code>retain()</code> and <code>release()</code> methods are gone. Buffers instead have a <code>close()</code> method, which will be called the end of the lifetime for the buffer. The buffers implement <code>AutoCloseable</code> as a convenience when the scope and lifetime of a buffer is entirely local.</p>
<p>Most places where <code>retain()</code> was used were effectively to cancel the effect of an unconditional <code>release()</code> in a super-class or sub-class.
In these cases, <code>split()</code> can be used instead, since these cases usually involve passing around a readable section of the buffer, and <code>split()</code> results in two buffers that must each be closed.</p>
<p>There is a new <code>send()</code> method, which can be used to encode in the type system that the "ownership" of a buffer moves from one place to another.
For instance, this is used by the <code>CompositeBuffer</code> factory methods to ensure that the composite buffer obtains exclusive access to the component buffers.
This prevents aliasing via buffer composition.</p>
<p>The buffers are now always big-endian, and the <code>*LE</code> accessor methods are gone.
To perform little-endian reads or writes, use the <code>reverseBytes</code> methods in <code>Integer</code> or <code>Long</code>, in conjunction with the big-endian read or write.</p>
<div class="markdown-heading">
<h2 class="heading-element" id="wiki-h2-5">Future / Promise</h2>
<a id="user-content-future--promise" class="anchor" aria-label="Permalink: Future / Promise" href="#future--promise"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-6">ChannelFuture / ChannelPromise removal</h3>
<a id="user-content-channelfuture--channelpromise-removal" class="anchor" aria-label="Permalink: ChannelFuture / ChannelPromise removal" href="#channelfuture--channelpromise-removal"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>To simplify the API and type-hierarchy we decided to remove the <code>ChannelFuture</code> / <code>ChannelPromise</code> (and all it sub-types / implementations) completely. As a replacement <code>Future&lt;Void&gt;</code> and <code>Promise&lt;Void&gt;</code> are use directly.</p>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-7">ProgressiveFuture / ProgressivePromise and ChannelProgressiveFuture / ChannelProgressivePromise removal</h3>
<a id="user-content-progressivefuture--progressivepromise-and-channelprogressivefuture--channelprogressivepromise-removal" class="anchor" aria-label="Permalink: ProgressiveFuture / ProgressivePromise and ChannelProgressiveFuture / ChannelProgressivePromise removal" href="#progressivefuture--progressivepromise-and-channelprogressivefuture--channelprogressivepromise-removal"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>The support for Progressive<em>Future / Progressive</em>Promise was completely removed in netty 5. The reason for this was that while it may have been useful sometimes it also did require that all handlers in the pipeline take special action here if they did chain up promises. This was not really the case and is quite cumbersome to do in reality.</p>
<p>Due the stated problems we decided that it would be best to just remove this feature all together as there was not much usage of this feature anyway. It is better to not support something at all than have something only work "sometimes". This also means there is less code to maintain.</p>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-8">VoidChannelPromise removal</h3>
<a id="user-content-voidchannelpromise-removal" class="anchor" aria-label="Permalink: VoidChannelPromise removal" href="#voidchannelpromise-removal"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>In netty 4.1.x it was possible to use the <code>voidPromise()</code> method to obtain a special <code>ChannelPromise</code> implementation that could be used for various IO operations (like <code>write</code>) to reduce the number of objects created. While the motivation of this feature was good it turned out that this special case of a <code>ChannelPromise</code> did actually bring a lot of problems:</p>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-9">API changes to Promise and Future</h3>
<a id="user-content-api-changes-to-promise-and-future" class="anchor" aria-label="Permalink: API changes to Promise and Future" href="#api-changes-to-promise-and-future"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<ul>
<li>The <code>Future.addListeners()</code>, <code>Future.removeListeners()</code>, and <code>Future.removeListener()</code> have been removed. We removed the ability to remove previous added listeners. This feature was not really used and so it allowed us to remove some complexity and remove some API surface.</li>
<li>A <code>Future.isFailed()</code> method has been added, that checks that the future is both completed and failed. This is similar to the existing <code>Future.isSuccess()</code> which checks that a future is both completed and successfully so.</li>
<li>New <code>Future.map()</code> and <code>Future.flatMap()</code> methods have been added, which makes it easy to compose and create new futures based on existing ones. These methods handle failures and cancellation properly through propagation.</li>
<li>New methods were added to convert to <code>CompletionStage</code> and so make it easier to interopt with other APIs.</li>
<li>All blocking methods were removed from the <code>Future</code> interface as it was easy for people to miss-use these and so block the <code>EventLoop</code>. If you still need to block from outside the <code>EventLoop</code> you will need to convert the <code>Future</code> via <code>Future.asStage()</code>. The returned <code>FutureCompletionStage</code> provides blocking methods.</li>
</ul>
<div class="markdown-heading">
<h2 class="heading-element" id="wiki-h2-10">Channel</h2>
<a id="user-content-channel" class="anchor" aria-label="Permalink: Channel" href="#channel"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-11">
<code>Channel.eventLoop()</code> renamed to <code>Channel.executor()</code>
</h3>
<a id="user-content-channeleventloop-renamed-to-channelexecutor" class="anchor" aria-label="Permalink: Channel.eventLoop() renamed to Channel.executor()" href="#channeleventloop-renamed-to-channelexecutor"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>In netty 5.x we added the <code>executor()</code> method to <code>ChannelOutboundInvoker</code> and as this method returns <code>EventExecutor</code> we did decide to remove the <code>eventLoop()</code> method from <code>Channel</code> and just override <code>executor()</code> to return <code>EventLoop</code> for <code>Channel</code>.</p>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-12">Return types changes from <code>ChannelFuture</code> to <code>Future&lt;Void&gt;</code>
</h3>
<a id="user-content-return-types-changes-from-channelfuture-to-futurevoid" class="anchor" aria-label="Permalink: Return types changes from ChannelFuture to Future&lt;Void&gt;" href="#return-types-changes-from-channelfuture-to-futurevoid"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>As we removed <code>ChannelFuture</code> / <code>ChannelPromise</code> we also changed the return type of the methods to <code>Future&lt;Void&gt;</code></p>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-13">Half-closure</h3>
<a id="user-content-half-closure" class="anchor" aria-label="Permalink: Half-closure" href="#half-closure"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>Netty5 has support for half-closure build in its core now. For this <code>ChannelHandler.shutdown</code> and <code>ChannelHandler.channelShutdown</code> were introduced. Beside this also <code>Channel.isShutdown(...)</code> and <code>ChannelOutboundInvoker.shutdown(...)</code> where added. This replace the old <code>DuplexChannel</code> abstraction, which was completely removed. For more details see <a href="https://github.com/netty/netty/pull/12468">the pull request #12468</a>.</p>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-14">
<code>ChannelHandlerContext</code> doesn't extend <code>AttributeMap</code> anymore</h3>
<a id="user-content-channelhandlercontext-doesnt-extend-attributemap-anymore" class="anchor" aria-label="Permalink: ChannelHandlerContext doesn't extend AttributeMap anymore" href="#channelhandlercontext-doesnt-extend-attributemap-anymore"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>We Changed ChannelHandlerContext to not extend AttributeMap anymore. In the case of you using attributes you should directly use <code>Channel</code> which still extends <code>AttributeMap</code>.</p>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-15">
<code>Channel.Unsafe</code> removal</h3>
<a id="user-content-channelunsafe-removal" class="anchor" aria-label="Permalink: Channel.Unsafe removal" href="#channelunsafe-removal"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>The Channel.Unsafe interface was completely removed so its not possible for the end-user to mess-up internals.</p>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-16">
<code>ChannelOutboundBuffer</code> not part of the <code>Channel</code> API anymore</h3>
<a id="user-content-channeloutboundbuffer-not-part-of-the-channel-api-anymore" class="anchor" aria-label="Permalink: ChannelOutboundBuffer not part of the Channel API anymore" href="#channeloutboundbuffer-not-part-of-the-channel-api-anymore"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>The <code>ChannelOutboundBuffer</code> is an implementation details of our <code>AbstractChannel</code> implementation and so was removed for the <code>Channel</code> itself completely.</p>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-17">
<code>Channel.beforeBeforeWritable()</code> removed and <code>Channel.bytesBeforeUnwritable()</code> renamed to <code>writableBytes()</code>.</h3>
<a id="user-content-channelbeforebeforewritable-removed-and-channelbytesbeforeunwritable-renamed-to-writablebytes" class="anchor" aria-label="Permalink: Channel.beforeBeforeWritable() removed and Channel.bytesBeforeUnwritable() renamed to writableBytes()." href="#channelbeforebeforewritable-removed-and-channelbytesbeforeunwritable-renamed-to-writablebytes"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>We removed the <code>Channel.beforeBeforeWritable()</code> method as it was not used at all and renamed <code>Channel.bytesBeforeUnwritable()</code> to <code>Channel.writableBytes</code>.</p>
<div class="markdown-heading">
<h2 class="heading-element" id="wiki-h2-18">ChannelPipeline</h2>
<a id="user-content-channelpipeline" class="anchor" aria-label="Permalink: ChannelPipeline" href="#channelpipeline"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-19">ChannelPipeline.add*(EventExecutorGroup...) removed</h3>
<a id="user-content-channelpipelineaddeventexecutorgroup-removed" class="anchor" aria-label="Permalink: ChannelPipeline.add*(EventExecutorGroup...) removed" href="#channelpipelineaddeventexecutorgroup-removed"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>In netty 4.x we added the ability to add <code>ChannelHandler</code>s to a <code>ChannelPipeline</code> with an explicit <code>EventExecutorGroup</code>. While this seemed like a good idea it turned out that it has quite some problems when it comes to life-cycles:</p>
<ul>
<li>
<code>handlerRemoved(...)</code> , <code>handlerAdded(...)</code> may be called at the "wrong time". This can result in a lot of problems. At worse it could mean that <code>handlerRemoved(...)</code> is called and the handler frees some native memory as it expect that the handler will never used anymore. What could happen here is that after it is called <code>channelRead(...)</code> may be called which then try to access the previous freed memory and so crash the JVM.</li>
<li>correctly implement "visibility" in terms of concurrent access / modifications of the pipeline is quite problematic as well.</li>
</ul>
<p>With this in mind we realised that really what the user mostly want is to have the incoming messages handled by another thread to process the business-logic. This is better be done in a custom implementation provided by the user as the user has a better handle on when things can be destroyed or not.</p>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-20">Return types changes from <code>ChannelFuture</code> to <code>Future&lt;Void&gt;</code>
</h3>
<a id="user-content-return-types-changes-from-channelfuture-to-futurevoid-1" class="anchor" aria-label="Permalink: Return types changes from ChannelFuture to Future&lt;Void&gt;" href="#return-types-changes-from-channelfuture-to-futurevoid-1"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>As we removed <code>ChannelFuture</code> / <code>ChannelPromise</code> we also changed the return type of the methods to <code>Future&lt;Void&gt;</code></p>
<div class="markdown-heading">
<h2 class="heading-element" id="wiki-h2-21">ChannelHandler</h2>
<a id="user-content-channelhandler" class="anchor" aria-label="Permalink: ChannelHandler" href="#channelhandler"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>Netty 5 greatly simplify the type-hierarchy for <code>ChannelHandler</code>s.</p>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-22">Simplified handler type hierarchy</h3>
<a id="user-content-simplified-handler-type-hierarchy" class="anchor" aria-label="Permalink: Simplified handler type hierarchy" href="#simplified-handler-type-hierarchy"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p><code>ChannelInboundHandler</code> and <code>ChannelOutboundHandler</code> have been merged into [<code>ChannelHandler</code>].  [<code>ChannelHandler</code>] now has both inbound and outbound handler methods. All outbound methods that took a <code>ChannelPromise</code> have been changed to return <code>Future&lt;Void&gt;</code>. This change makes usage less error-prone and simplifies the API.</p>
<p><code>ChannelInboundHandlerAdapter</code>, <code>ChannelOutboundHandlerAdapter</code>, and <code>ChannelDuplexHandlerAdapter</code> have been removed and replaced by [<code>ChannelHandlerAdapter</code>].</p>
<p>Because it is now impossible to tell if a handler is an inbound handler or an outbound handler, <code>CombinedChannelDuplexHandler</code> has been replaced by [<code>ChannelHandlerAppender</code>].</p>
<p>For more information about this change, please refer to <a href="https://github.com/netty/netty/pull/1999">the pull request #1999</a>.</p>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-23">
<code>channelRead0()</code> → <code>messageReceived()</code>
</h3>
<a id="user-content-channelread0--messagereceived" class="anchor" aria-label="Permalink: channelRead0() → messageReceived()" href="#channelread0--messagereceived"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>If you are using [<code>SimpleChannelInboundHandler</code>], you have to rename <code>channelRead0()</code> to <code>messageReceived()</code>.</p>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-24">User events</h3>
<a id="user-content-user-events" class="anchor" aria-label="Permalink: User events" href="#user-events"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>It's now possible to fire user / custom events in both directions through the pipeline. For inbound events you would use <code>fireChannelInboundEvent(...)</code> (replacement of <code>fireUserEventTriggered(...)</code> and for outbound events <code>sendOutboundEvent(...)</code>.
Both of these can be intercepted by methods defined in <code>ChannelHandler</code> as usual.</p>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-25">
<code>ChannelHandler.pendingOutboundBytes(...)</code> method added</h3>
<a id="user-content-channelhandlerpendingoutboundbytes-method-added" class="anchor" aria-label="Permalink: ChannelHandler.pendingOutboundBytes(...) method added" href="#channelhandlerpendingoutboundbytes-method-added"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>It's now easily possible to influence the writability of the <code>Channel</code> by the contained <code>ChannelHandler</code> in the <code>ChannelPipeline</code>. This makes it possible to influence back pressure when the <code>ChannelHandler</code> itself buffers outbound data.</p>
<div class="markdown-heading">
<h2 class="heading-element" id="wiki-h2-26">EventLoopGroup / EventLoop</h2>
<a id="user-content-eventloopgroup--eventloop" class="anchor" aria-label="Permalink: EventLoopGroup / EventLoop" href="#eventloopgroup--eventloop"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>While in netty 4.x we had different <code>EventLoopGroup</code> / <code>EventLoop</code> implementations for the various different transports (i.e. <code>NioEventLoopGroup</code>, <code>EpollEventLoopGroup</code>....) we changed this in netty 5 to just have one <code>EventLoopGroup</code> implementation which is called <code>MultiThreadEventLoopGroup</code>. This <code>MultiThreadEventLoopGroup</code> takes an <code>IoHandlerFactory</code> which is specific to the transport itself (i.e. <code>NioHandler.newFactory()</code>, <code>EpollHandler.newFactory()</code>....). This change gives a lot of advantages. For example it is easy to extend the <code>MultiThreadEventLoopGroup</code> and so decorate things or add custom metrics etc. This implementation can then be re-used across different transports. This is very similar to what the JDK provides with <code>ThreadPoolExecutor</code> in terms of the possibility of customisations.</p>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-27">
<code>EventLoopGroup.isCompatible(...)</code> method added</h3>
<a id="user-content-eventloopgroupiscompatible-method-added" class="anchor" aria-label="Permalink: EventLoopGroup.isCompatible(...) method added" href="#eventloopgroupiscompatible-method-added"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>It's now possible to check if a <code>Channel</code> sub-type is compatible with the <code>EventLoopGroup</code> / <code>EventLoop</code> before trying to use it. This can help to select the correct <code>Channel</code> sub-type.</p>
<div class="markdown-heading">
<h3 class="heading-element" id="wiki-h3-28">
<code>EventLoop.registerForIo(...)</code> and <code>EventLoop.deregisterForIo</code> added</h3>
<a id="user-content-eventloopregisterforio-and-eventloopderegisterforio-added" class="anchor" aria-label="Permalink: EventLoop.registerForIo(...) and EventLoop.deregisterForIo added" href="#eventloopregisterforio-and-eventloopderegisterforio-added"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>New methods were added to the <code>EventLoop</code> interface to allow registration and deregistration of <code>Channel</code>s. These should not be used by the user directly but by <code>Channel</code> implementations itself.</p>
<div class="markdown-heading">
<h2 class="heading-element" id="wiki-h2-29">Rarely used codecs moved to Netty Contrib</h2>
<a id="user-content-rarely-used-codecs-moved-to-netty-contrib" class="anchor" aria-label="Permalink: Rarely used codecs moved to Netty Contrib" href="#rarely-used-codecs-moved-to-netty-contrib"><svg class="octicon octicon-link" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>
</div>
<p>To slim the code base down and ease the maintenance burden, the following codecs and handlers have been moved to <a href="https://github.com/netty-contrib">Netty Contrib</a>:</p>
<ul>
<li>netty-codec-xml</li>
<li>netty-codec-redis</li>
<li>netty-codec-memcache</li>
<li>netty-codec-stomp</li>
<li>netty-codec-haproxy</li>
<li>netty-codec-mqtt</li>
<li>netty-codec-socks</li>
<li>netty-handler-proxy</li>
<li><code>io.netty.handler.codec.json</code></li>
<li><code>io.netty.handler.codec.marshalling</code></li>
<li><code>io.netty.handler.codec.protobuf</code></li>
<li><code>io.netty.handler.codec.serialization</code></li>
<li><code>io.netty.handler.codec.xml</code></li>
<li><code>io.netty.handler.pcap</code></li>
</ul>

              </div>

              <div id="wiki-footer" class="mt-5 Link--muted wiki-footer">
                <a class="d-block p-3 Link--muted text-center border border-dashed rounded-2" href="_new?wiki%5bname%5d=_footer.html">
                  <svg aria-hidden="true" height="16" viewbox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-plus mr-1">
    <path d="M7.75 2a.75.75 0 0 1 .75.75V7h4.25a.75.75 0 0 1 0 1.5H8.5v4.25a.75.75 0 0 1-1.5 0V8.5H2.75a.75.75 0 0 1 0-1.5H7V2.75A.75.75 0 0 1 7.75 2Z"></path>
</svg> Add a custom footer
</a>              </div>
          </div></div>
<div class="toc-container col-md-3 hidden-xs hidden-sm hidden-print" role="complementary">
<div class="toc well">
<ul class="nav nav-list nav-stacked">
<li class="nav-header">Table of Contents
</li><li><a href="#wiki-h2-0" title="Package">Package</a>
</li><li><a href="#wiki-h2-1" title="Buffers">Buffers</a>
<ul class="nav nav-list nav-stacked"><li><a href="#wiki-h3-2" title="Capacity">Capacity</a>
</li><li><a href="#wiki-h3-3" title="Adaptors">Adaptors</a>
</li><li><a href="#wiki-h3-4" title="Changes in API">Changes in API</a>
</li></ul></li><li><a href="#wiki-h2-5" title="Future / Promise">Future / Promise</a>
<ul class="nav nav-list nav-stacked"><li><a href="#wiki-h3-6" title="ChannelFuture / ChannelPromise removal">ChannelFuture / ChannelPromise removal</a>
</li><li><a href="#wiki-h3-7" title="ProgressiveFuture / ProgressivePromise and ChannelProgressiveFuture / ChannelProgressivePromise removal">ProgressiveFuture / ProgressivePromise and ChannelProgressiveFuture / ChannelProgressivePromise removal</a>
</li><li><a href="#wiki-h3-8" title="VoidChannelPromise removal">VoidChannelPromise removal</a>
</li><li><a href="#wiki-h3-9" title="API changes to Promise and Future">API changes to Promise and Future</a>
</li></ul></li><li><a href="#wiki-h2-10" title="Channel">Channel</a>
<ul class="nav nav-list nav-stacked"><li><a href="#wiki-h3-11" title="Channel.eventLoop() renamed to Channel.executor()">Channel.eventLoop() renamed to Channel.executor()</a>
</li><li><a href="#wiki-h3-12" title="Return types changes from ChannelFuture to Future&lt;Void&gt;">Return types changes from ChannelFuture to Future&lt;Void&gt;</a>
</li><li><a href="#wiki-h3-13" title="Half-closure">Half-closure</a>
</li><li><a href="#wiki-h3-14" title="ChannelHandlerContext doesn&apos;t extend AttributeMap anymore">ChannelHandlerContext doesn&apos;t extend AttributeMap anymore</a>
</li><li><a href="#wiki-h3-15" title="Channel.Unsafe removal">Channel.Unsafe removal</a>
</li><li><a href="#wiki-h3-16" title="ChannelOutboundBuffer not part of the Channel API anymore">ChannelOutboundBuffer not part of the Channel API anymore</a>
</li><li><a href="#wiki-h3-17" title="Channel.beforeBeforeWritable() removed and Channel.bytesBeforeUnwritable() renamed to writableBytes().">Channel.beforeBeforeWritable() removed and Channel.bytesBeforeUnwritable() renamed to writableBytes().</a>
</li></ul></li><li><a href="#wiki-h2-18" title="ChannelPipeline">ChannelPipeline</a>
<ul class="nav nav-list nav-stacked"><li><a href="#wiki-h3-19" title="ChannelPipeline.add*(EventExecutorGroup...) removed">ChannelPipeline.add*(EventExecutorGroup...) removed</a>
</li><li><a href="#wiki-h3-20" title="Return types changes from ChannelFuture to Future&lt;Void&gt;">Return types changes from ChannelFuture to Future&lt;Void&gt;</a>
</li></ul></li><li><a href="#wiki-h2-21" title="ChannelHandler">ChannelHandler</a>
<ul class="nav nav-list nav-stacked"><li><a href="#wiki-h3-22" title="Simplified handler type hierarchy">Simplified handler type hierarchy</a>
</li><li><a href="#wiki-h3-23" title="channelRead0() → messageReceived()">channelRead0() → messageReceived()</a>
</li><li><a href="#wiki-h3-24" title="User events">User events</a>
</li><li><a href="#wiki-h3-25" title="ChannelHandler.pendingOutboundBytes(...) method added">ChannelHandler.pendingOutboundBytes(...) method added</a>
</li></ul></li><li><a href="#wiki-h2-26" title="EventLoopGroup / EventLoop">EventLoopGroup / EventLoop</a>
<ul class="nav nav-list nav-stacked"><li><a href="#wiki-h3-27" title="EventLoopGroup.isCompatible(...) method added">EventLoopGroup.isCompatible(...) method added</a>
</li><li><a href="#wiki-h3-28" title="EventLoop.registerForIo(...) and EventLoop.deregisterForIo added">EventLoop.registerForIo(...) and EventLoop.deregisterForIo added</a>
</li></ul></li><li><a href="#wiki-h2-29" title="Rarely used codecs moved to Netty Contrib">Rarely used codecs moved to Netty Contrib</a>
<ul class="nav nav-list nav-stacked"><li><a href="#wiki-h3-30" title="Toggle table of contents

      Pages 30">Toggle table of contents

      Pages 30</a>
</li></ul>
</li></ul>
</div>
</div>
</div>

<div class="row">
<div class="col-md-9">
<div class="text-right">
<small>Last retrieved on 13-Nov-2024</small>
</div>
</div>
</div>
</div>

</div>

</div>
<div class="container">
<hr>
<div id="footer">
<p>
Copyright &copy; 2024
<a href="../index.html">The Netty project</a>
</p>
</div>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js" type="text/javascript"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js" type="text/javascript"></script>
<script src="../lib/common.footer.js" type="text/javascript"></script>

<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-95307-5', 'auto');
ga('require', 'displayfeatures');
ga('require', 'linkid', 'linkid.js');
ga('send', 'pageview');
</script>
</body>
</html>
