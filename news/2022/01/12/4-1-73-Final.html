<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Netty.news: Netty 4.1.73.Final released</title>
<title>Netty: Netty 4.1.73.Final released</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport">
<link href="../../../../images/favicon.ico" rel="shortcut icon">
<link href="//feeds.feedburner.com/netty_project" rel="alternate" title="News Feed" type="application/rss+xml">
<style>
  body {
    padding-top: 60px;
  }
</style>
<link href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" media="screen" rel="stylesheet" type="text/css">
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" media="screen" rel="stylesheet" type="text/css">
<script src="../../../../lib/sh/scripts/shCore.js" type="text/javascript"></script>
<script src="../../../../lib/sh/scripts/shBrushXml.js" type="text/javascript"></script>
<link href="../../../../lib/sh/styles/shCore.css" rel="stylesheet" type="text/css">
<link href="../../../../lib/sh/styles/shThemeDefault.css" rel="stylesheet" type="text/css">
<link href="../../../../lib/common.css" rel="stylesheet" type="text/css">
<script src="../../../../lib/common.js" type="text/javascript"></script>
<!--[if lt IE 9]>
<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.js" type="text/javascript"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/respond.js/1.3.0/respond.js" type="text/javascript"></script>
<![endif]-->
</head>
<body>
<a class="sr-only" href="#content" id="top">Skip navigation</a>
<nav class="navbar navbar-default navbar-fixed-top hidden-print" id="header" role="navigation">
<div class="container">
<div class="navbar-header">
<button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="../../../../index.html">
<span class="navbar-brand-logo"></span>
Netty project
</a>
</div>
<div class="navbar-collapse collapse">
<ul class="nav navbar-nav">
<li class="dropdown">
<a href="../../../../news/2024/01/12/ohttp-0-0-4-Final.html">
News
</a>
<ul class="dropdown-menu">
<li>
<a href="../../../../news/index.html">
<i class="fa fa-archive"></i>
Archive
</a>
</li>
</ul>
</li>
<li class="dropdown">
<a href="../../../../downloads.html">
Downloads
</a>
<ul class="dropdown-menu">
<li>
<a href="https://github.com/netty/netty/archive/refs/tags/netty-5.0.0.Alpha5.tar.gz">
<i class="fa fa-cloud-download"></i>
5.0.0.Alpha5
<small>&dash; 28-Sep-2022</small>
</a>
</li>
<li>
<a href="https://github.com/netty/netty/archive/refs/tags/netty-4.1.104.Final.tar.gz">
<i class="fa fa-cloud-download"></i>
4.1.104.Final
<small>&dash; 15-Dec-2023</small>
</a>
</li>
<li>
<a href="https://github.com/netty/netty/archive/refs/tags/netty-4.0.56.Final.tar.gz">
<i class="fa fa-cloud-download"></i>
4.0.56.Final
<small>&dash; 05-Feb-2018</small>
</a>
</li>
<li>
<a href="https://github.com/netty/netty/archive/refs/tags/netty-3.10.6.Final.tar.gz">
<i class="fa fa-cloud-download"></i>
3.10.6.Final
<small>&dash; 29-Jun-2016</small>
</a>
</li>
<li>
<a href="https://www.tldrlegal.com/l/APACHE2">
<i class="fa fa-gavel"></i>
Apache License 2.0
</a>
</li>
<li>
<a href="https://github.com/netty/netty/releases">
<i class="fa fa-archive"></i>
Previous Releases
</a>
</li>
<li>
<a href="https://oss.sonatype.org/content/repositories/snapshots/io/netty/">
<i class="fa fa-flask"></i>
Nightly Builds
</a>
</li>
</ul>
</li>
<li class="dropdown">
<a href="../../../../wiki/index.html">
Documentation
</a>
<ul class="dropdown-menu">
<li>
<a href="../../../../wiki/user-guide.html">
<i class="fa fa-book"></i>
User guide
</a>
</li>
<li>
<a href="../../../../5.0/api/index.html">
<i class="fa fa-file-text"></i>
Javadoc - 5.0
</a>
</li>
<li>
<a href="../../../../4.1/api/index.html">
<i class="fa fa-file-text"></i>
Javadoc - 4.1
</a>
</li>
<li>
<a href="../../../../4.0/api/index.html">
<i class="fa fa-file-text"></i>
Javadoc - 4.0
</a>
</li>
<li>
<a href="../../../../3.10/api/index.html">
<i class="fa fa-file-text"></i>
Javadoc - 3.10
</a>
</li>
<li>
<a href="../../../../wiki/all-documents.html">
<i class="fa fa-list"></i>
All Documents
</a>
</li>
<li>
<a href="../../../../wiki/related-articles.html">
<i class="fa fa-bookmark"></i>
Related Articles
</a>
</li>
<li class="hidden-xs" id="bookpromo-dropdown">
<a href="https://www.manning.com/maurer/">
<img src="../../../../images/netty-in-action.gif">
<br>
<small>
Use code <strong>mlnettyco</strong>
<br>
for a 37% discount!
</small>
</a>
</li>
</ul>
</li>
<li class="dropdown">
<a href="../../../../community.html">
Get Involved
</a>
<ul class="dropdown-menu">
<li>
<a href="https://github.com/netty/netty">
<i class="fa fa-github-square"></i>
Github
</a>
</li>
<li>
<a href="https://stackoverflow.com/questions/tagged/netty">
<i class="fa fa-stack-overflow"></i>
StackOverflow
</a>
</li>
<li>
<a href="https://twitter.com/netty_project">
<i class="fa fa-twitter-square"></i>
@netty_project
</a>
</li>
<li>
<a href="../../../../wiki/developer-guide.html">
<i class="fa fa-cogs"></i>
Developer Guide
</a>
</li>
<li>
<a href="https://discord.gg/GkGzzdQM5d">
<i class="fa fa-comment"></i>
Discord Server
</a>
</li>
<li>
<a href="../../../../sponsor/thanks.html">
<i class="fa fa-usd"></i>
Sponsors
</a>
</li>
<li>
<a href="../../../../wiki/adopters.html">
<i class="fa fa-users"></i>
Adopters
</a>
</li>
<li>
<a href="../../../../wiki/related-projects.html">
<i class="fa fa-chain"></i>
Related Projects
</a>
</li>
</ul>
</li>
<li class="visible-xs" id="bookpromo-nav">
<a href="https://www.manning.com/maurer/">
<img src="../../../../images/netty-in-action.gif">
<br>
<small>
Use code <strong>mlnettyco</strong>
<br>
for a 37% discount!
</small>
</a>
</li>
<li>
<a href="https://feeds.feedburner.com/netty_project">
<i class="fa fa-rss"></i>
</a>
</li>
</ul>
<form action="../../../../search.html" class="navbar-form navbar-right hidden-sm" method="GET" onsubmit="return validateGlobalSearchQuery()" role="search">
<div class="form-group">
<input class="search-query form-control" id="global-search-query" name="q" placeholder="Search" type="text">
</div>
</form>
</div>
</div>
</nav>
<div id="content">
<div class="container">
<div class="row">
<div class="col-md-9">
<div class="news-item" id="main-content">
<h1>
Netty 4.1.73.Final released
</h1>
<p class="byline">
<small>
by
<a href="https://github.com/normanmaurer">normanmaurer</a>
<br>
on
<time datetime="2022-01-12">12-Jan-2022</time>
</small>
</p>
<div class="news-content">
<p>We are happy to announce the release of netty 4.1.73.Final, which is the first netty release for this year (late Happy New Year!). Because this release fixes a few bugs in "core parts" of netty we highly recommend everyone to upgrade.</p>

<p>The most important changes are:</p>

<ul>
<li>Make "pinned memory" from PooledByteBufAllocator reflect buffers in use (<a href="https://github.com/netty/netty/pull/11990">#11990</a>)</li>
<li>Ensure the side which enables SO_LINGER and call showdownOutput to start TCP half-closure in fin_wait2 state can still receive and process the data which is send by another side in the close_wait state (<a href="https://github.com/netty/netty/pull/11982">#11982</a>)</li>
<li>Correctly calculate the elementSize when cache alignment is configured (<a href="https://github.com/netty/netty/pull/11987">#11987</a>)</li>
<li>WebSocketServerProtocolHandshakeHandler should work without aggregation (<a href="https://github.com/netty/netty/pull/11976">#11976</a>)</li>
<li>Fix: Make ByteToMessageDecoder not call read() in channelReadComplete, if no channelRead fired. (<a href="https://github.com/netty/netty/pull/11966">#11966</a>)</li>
<li>Add a lock-based message passing queue to help debug a problem with Recycler (<a href="https://github.com/netty/netty/pull/11972">#11972</a>)</li>
<li>Fix ByteBufUtil.indexOf(buf, buf) (<a href="https://github.com/netty/netty/pull/11970">#11970</a>)</li>
<li>do not periodically re-read /etc/hosts by default (<a href="https://github.com/netty/netty/pull/11943">#11943</a>)</li>
<li>Fix ArrayIndexOutOfBounds: 39 from PoolArena.findSubpagePoolHead (<a href="https://github.com/netty/netty/pull/11939">#11939</a>)</li>
<li>Allow to disable duplicate native library check (<a href="https://github.com/netty/netty/pull/11928">#11928</a>)</li>
<li>Allow same native libraries if content is the same (<a href="https://github.com/netty/netty/pull/11927">#11927</a>)</li>
</ul>


<p>For the details and all changes, please browse our issue tracker for <a href="https://github.com/netty/netty/issues?page=1&amp;q=is%3Aclosed+milestone%3A4.1.73.Final">4.1.73.Final</a>.</p>

<h1>Important notes</h1>

<h2>Relaxing duplicated native library detection.</h2>

<p>The last netty release did include a change that will detect if there may be conflicting native libraries on the classpath and if so fail to load these. This change was introduced to guard against possible side-effects like segfaults. While the change itself makes a lot of sense and is correct we found out that it might be a bit to "restrictive" in some cases and users might need time to resolve these duplicated native libraries problems when the application has a complex dependency-graph. Because of this we made two changes in this release:</p>

<ul>
<li>Allow same native libraries if content is the same (<a href="https://github.com/netty/netty/pull/11927">#11927</a>)</li>
<li>Allow to disable duplicate native library check (<a href="https://github.com/netty/netty/pull/11928">#11928</a>)</li>
</ul>


<p>The first mentioned change relaxes the duplicate native library check a bit and so will allow to have the same native library with the same content on the classpath and still be able to load it.
The second change allows to disable the check all-together with a system property and so will allow you to try use the native library even if you have multiple conflicting native libraries on the classpath. Doing this is risky and should general be avoided due the reasons mentioned above. That said it can be used as an escape-path while fixing the dependency-graph. The problem itself will still be logged so people are aware of it.</p>

<h2>ArrayIndexOutOfBoundsException when PooledByteBufAllocator is used.</h2>

<p>This release fixes a bug which can cause an ArrayIndexOutOfBoundsException when using the PooledByteBufAllocator. This bug exists forever and is basically a use-after-free bug. For more details see <a href="https://github.com/netty/netty/pull/11939">#11939</a>.</p>

<h2>Do not periodically re-read /etc/hosts by default</h2>

<p>The last netty release did introduce a change which caused <code>/etc/hosts</code> to be re-read every 60 seconds. This was done to ensure we pick-up changes without the need of restarting. Unfortunately, what we didnt think about was that the disk IO might block and so can cause the EventLoop to block as well for a small amount of time. Because of this we did change the default to not re-read the file periodically in this release. If you really want to re-enable it it can be done via system property. For more details see <a href="https://github.com/netty/netty/pull/11943">#11943</a>.</p>

<h2>Add a lock-based message passing queue to help debug a problem with Recycler</h2>

<p>One of our users reported a problem in the new <code>Recycler</code> implementation which did cause heavy CPU usage while polling from the internal queue. We were not able to reproduce this at all and the problem only happened for one user on ARM with an old JDK. Because of this we currently believe its caused by a JDK bug. That said to allow users to workaround the problem if it happens we introduced a system property which allows to switch the internal queue used by <code>Recycler</code>.
If you suffer from the mentioned problem please report back to us and use the property to workaround the issue as mentioned in <a href="https://github.com/netty/netty/pull/11972">#11972</a>.</p>

<h1>Thank You</h1>

<p>Every idea and bug-report counts and so we thought it is worth mentioning those who helped in this area.</p>

<p>Please report an unintended omission.</p>

<ul>
<li><a href="https://github.com/alex-lx">@alex-lx</a></li>
<li><a href="https://github.com/BuddhiWathsala">@BuddhiWathsala</a></li>
<li><a href="https://github.com/chrisvest">@chrisvest</a></li>
<li><a href="https://github.com/dchristle">@dchristle</a></li>
<li><a href="https://github.com/ebradshaw">@ebradshaw</a></li>
<li><a href="https://github.com/eltociear">@eltociear</a></li>
<li><a href="https://github.com/faceless2">@faceless2</a></li>
<li><a href="https://github.com/hoverwinter">@hoverwinter</a></li>
<li><a href="https://github.com/hxnan">@hxnan</a></li>
<li><a href="https://github.com/johnou">@johnou</a></li>
<li><a href="https://github.com/huibinliupush">@huibinliupush</a></li>
<li><a href="https://github.com/laosijikaichele">@laosijikaichele</a></li>
<li><a href="https://github.com/majecty">@majecty</a></li>
<li><a href="https://github.com/mostroverkhov">@mostroverkhov</a></li>
<li><a href="https://github.com/normanmaurer">@normanmaurer</a></li>
<li><a href="https://github.com/pderop">@pderop</a></li>
<li><a href="https://github.com/seatrain">@seatrain</a></li>
<li><a href="https://github.com/sergiitk">@sergiitk</a></li>
<li><a href="https://github.com/Scottmitch">@Scottmitch</a></li>
<li><a href="https://github.com/Xxpain">@Xxpain</a></li>
<li><a href="https://github.com/yawkat">@yawkat</a></li>
<li><a href="https://github.com/YunWZ">@YunWZ</a></li>
</ul>


</div>
<ul class="pager">
<li class="previous">
<a href="../../../../news/2021/12/14/multiple_releases.html">&larr; Older</a>
</li>
<li>
<a href="../../../index.html">List all news items</a>
</li>
<li class="next">
<a href="../../../../news/2022/02/08/4-1-74-Final.html">Newer &rarr;</a>
</li>
</ul>
</div>
<div class="comments">

            <div id="disqus_thread"></div>
            <script type="text/javascript">
            var disqus_shortname = 'netty0';
            var disqus_url = "http://netty.io/news/2022/01/12/4-1-73-Final.html";
            var disqus_developer = null;
            var disqus_identifier = "news/2022-01-12-4-1-73-Final";
            (function() {
              var dsq = document.createElement("script"); dsq.type = "text/javascript"; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName("head")[0] || document.getElementsByTagName("body")[0]).appendChild(dsq);
            })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=netty0">comments powered by Disqus.</a></noscript>
          
</div>
</div>
</div>

</div>

</div>
<div class="container">
<hr>
<div id="footer">
<p>
Copyright &copy; 2024
<a href="../../../../index.html">The Netty project</a>
</p>
</div>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js" type="text/javascript"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js" type="text/javascript"></script>
<script src="../../../../lib/common.footer.js" type="text/javascript"></script>

<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-95307-5', 'auto');
ga('require', 'displayfeatures');
ga('require', 'linkid', 'linkid.js');
ga('send', 'pageview');
</script>
</body>
</html>
